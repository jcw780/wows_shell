<!doctype html>
<html>

<meta charset="UTF-8">
<script>
    console.log('Started');
    var safe = false;
    var Module = {
        onRuntimeInitialized: function () {

            runFunc();
            safe = true;
        }
    };
    //console.log(safe);
    var instance;
    function runFunc() {
        console.log('Entered');
        instance = new Module.shell(2);
        instance.setValues(.460, 780, .292 , 1460, 2574, 6, .033, 76, 45, 60, 0);
        instance.setValues(.220, 995, .2549,  207, 2574, 7, .022, 37, 55, 65, 1);
        //console.log(instance);
        instance.calcImpact();
        //instance.printImpact();
        console.log("ran");
        var angles = [10];
        instance.calcAngles(70, -20);
        instance.calcPostPen(70, -20, angles, true, false);

        console.log("ran");
        //instance.printPostPen();
        //instance.delete();
        for(var num = 0; num < 2; num++){
            for (var i = 0; i < instance.getImpactSize(); i++) {
                console.log(i, instance.getAnglePoint(i, Module.angleDataIndex.distance.value, num),
                    instance.getAnglePoint(i, Module.angleDataIndex.ra0.value, num)
                );
            }


            for (var i = 0; i < instance.getImpactSize(); i++) {
                //console.log(i);
                console.log(i, instance.getPostPenPoint(i, Module.postPenDataIndex.distance.value, 0, num),
                    instance.getPostPenPoint(i, Module.postPenDataIndex.x.value, 0, num),
                    instance.getPostPenPoint(i, Module.postPenDataIndex.xwf.value, 0, num)
                );
            }
        }

        instance.setValues(.460, 780, .292 , 1460, 2574, 6, .033, 76, 45, 60, 0);
        instance.setValues(.220, 995, .2549,  207, 2574, 7, .022, 37, 55, 65, 1);
        instance.calcImpact();
        console.log("ran");
        instance.calcAngles(70, -20);
        instance.calcPostPen(70, -20, angles, true, false);

        console.log("ran");
        //instance.printPostPen();
        //instance.delete();
        for(var num = 0; num < 2; num++){
            for (var i = 0; i < instance.getImpactSize(); i++) {
                console.log(i, instance.getAnglePoint(i, Module.angleDataIndex.distance.value, num),
                    instance.getAnglePoint(i, Module.angleDataIndex.ra0.value, num)
                );
            }


            for (var i = 0; i < instance.getImpactSize(); i++) {
                //console.log(i);
                console.log(i, instance.getPostPenPoint(i, Module.postPenDataIndex.distance.value, 0, num),
                    instance.getPostPenPoint(i, Module.postPenDataIndex.x.value, 0, num),
                    instance.getPostPenPoint(i, Module.postPenDataIndex.xwf.value, 0, num)
                );
            }
        }
    }
    if (safe) {
        runFunc();
    }
    //}



</script>
<script src="shellWasm.js"></script>

<body>
    <button type="button" onclick="runFunc()">Test</button>
</body>

</html>